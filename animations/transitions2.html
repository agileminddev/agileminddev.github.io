<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
	This is basically one giant hack and not very good code. Try not to cringe too badly...
-->
<head>
	<meta http-equiv="Content-Language" content="en-US" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="Cache-Control" content="no-store" />
	<meta http-equiv="Pragma" content="no-cache" />
	<meta http-equiv="Expires" content="0" />
	<meta content="text/html;charset=utf-8" http-equiv="Content-type" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="icon" href="../favicon.ico" type="image/x-icon" />
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
	<title>Animation Transitions</title>
	<style>
		@font-face {
			font-family: 'Lato';
			src: url(Lato-Regular.ttf) format("truetype");
			font-style: normal
		}

		body {
			background-color: #FAF9F6;
			color: black;
			font-family: 'Lato', 'Lucida Sans Unicode', Helvetica, Arial, Verdana, sans-serif;
			min-width: 800px;
		}

		span.nowrap {
			white-space: nowrap;
		}

		.outer {
			margin-left: auto;
			margin-right: auto;
			max-width: 800px;
			background-color: #FFFFFF;
			line-height: 1.6em;
		}

		.container {
			max-width: 800px;
			min-width: 536px;
			display: flex;
			flex-wrap: wrap;
			justify-content: space-evenly;
			font-size: 11.5pt;
			margin: 1em;
			overflow: clip;
			position: relative;
		}

		.big-play {
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translateX(-50%) translateY(-50%);
			z-index: 10;
			background-color: transparent;
			border: none;
		}

		.big-play,
		.pointer {
			cursor: pointer;
		}

		.big-play-hide {
			opacity: 0;
		}

		.big-play-in {
			animation-name: fade-in;
			animation-iteration-count: 1;
			animation-timing-function: ease-in-out;
			animation-duration: 0.25s;
		}

		.big-play-out {
			animation-name: spin-out;
			animation-iteration-count: 1;
			animation-timing-function: ease-in;
			animation-duration: 0.5s;
		}

		.big-play img {
			height: 5em;
			width: 5em;
		}

		.text {
		}

		.animation {
			margin-top: 1em;
			visibility: hidden;
		}

		.animation-in {
			visibility: visible;
			animation-name: slide-in-from-right;
			animation-iteration-count: 1;
			animation-timing-function: ease-in-out;
			animation-duration: 1s;
		}

		.frame {
		}

		.panel {
			justify-content: center;
		}

		.panel img {
			display: block;
			margin: auto;
			width: 80%;
		}

		.message {
			max-height: 0;
			height: auto;
			overflow: hidden;
		}

		.message.animate {
			animation-name: hello-text;
			animation-iteration-count: 1;
			animation-timing-function: ease-out;
			animation-duration: 2s;
			max-height: 80px; /* make up a max height */
		}

		@keyframes hello-text {
			0% {
				max-height: 0;
			}

			100% {
				max-height: 80px;
			}
		}

		@keyframes fade-in {
			0% {
				opacity: 0;
			}

			100% {
				opacity: 1;
			}
		}

		@keyframes spin-out {
			0% {
				transform: translateX(-50%) translateY(-50%) rotateY(0deg);
				opacity: 1;
			}

			95% {
				opacity: 0;
			}

			100% {
				transform: translateX(-50%) translateY(-50%) rotateY(810deg);
			}
		}

		@keyframes slide-in-from-right {
			0% {
				translate: 800px 0;
			}

			100% {
				translate: 0 0;
			}
		}

		#controlbar {
			width: 100%;
			height: 40px;
			background: url('controlbarslice.png') repeat-x;
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			align-items: center;
		}

		#controlbar > span {
			margin-top: 3px;
		}

		#controlbar #buttons {
			justify-self: start;
			grid-column: 1;
			grid-row: 1;
		}

		#controlbar #frames {
			justify-self: center;
			grid-column: 2;
			grid-row: 1;
		}

		#controlbar #controls {
			justify-self: end;
			grid-column: 3;
			grid-row: 1;
		}

		#controlbar button {
			background-color: transparent;
			border: none;
			cursor: pointer;
			padding: 2px;
		}

		#controlbar button:active {
			transform: scale(0.98);
			box-shadow: 0px 0px 2px 2px rgba(213, 230, 247, 0.75);
			background-color: rgba(213, 230, 247, 0.75);
			border-radius: 50%;
		}

		#controlbar button:disabled {
			cursor: default;
		}

		#play-button,
		#pause-button {
			font-size: 48px;
			font-variation-settings: 'FILL' 1, 'opsz' 48;
		}

		#pause-button {
			display: none;
		}

		#skip-button {
			font-size: 40px;
			font-variation-settings: 'FILL' 1, 'opsz' 40;
		}

		.active-frame {
			font-variation-settings: 'FILL' 1, 'opsz' 48;
			cursor: default !important;
		}

		#speed {
			vertical-align: top;
		}

		#waiting {
			display: flex;
			max-height: 0;
			height: auto;
			overflow: hidden;
		}

		#waiting.show {
			animation-name: hello-text;
			animation-iteration-count: 1;
			animation-timing-function: ease-out;
			animation-duration: 2s;
			max-height: 80px;
		}

		#waiting-message {
			font-size: larger;
			padding-right: 0.5em;
			color: #0b5394;
		}

		#waiting-effect {
			display: flex;
			align-items: center;
		}

		#waiting-effect span {
			display: inline-block;
			width: 15px;
			height: 15px;
			border-radius: 50%;
			margin: 0 5px;
			position: relative;
		}

		#waiting-effect span::before {
			content: "";
			position: absolute;
			width: 100%;
			height: 100%;
			background-color: inherit;
			border-radius: 50%;
			z-index: -1;
			animation-name: ripples;
			animation-iteration-count: infinite;
			animation-timing-function: ease-out;
			animation-duration: 2.5s;
		}

		#waiting-effect span:first-child {
			background-color: #23649e;
			transform: scale(1);
		}

		#waiting-effect span:first-child::before {
			animation-delay: 0s;
		}

		#waiting-effect span:nth-child(2) {
			background-color: #3b75a9;
			transform: scale(0.95);
		}

		#waiting-effect span:nth-child(2)::before {
			animation-delay: 0.2s;
		}

		#waiting-effect span:nth-child(3) {
			background-color: #5486b4;
			transform: scale(0.9);
		}

		#waiting-effect span:nth-child(3)::before {
			animation-delay: 0.4s;
		}

		#waiting-effect span:nth-child(4) {
			background-color: #6c97be;
			transform: scale(0.85);
		}

		#waiting-effect span:nth-child(4)::before {
			animation-delay: 0.6s;
		}

		#waiting-effect span:nth-child(5) {
			background-color: #85a9c9;
			transform: scale(0.8);
		}

		#waiting-effect span:nth-child(5)::before {
			animation-delay: 0.8s;
		}

		#waiting-effect span:nth-child(6) {
			background-color: #9dbad4;

			transform: scale(0.75);
		}

		#waiting-effect span:nth-child(6)::before {
			animation-delay: 1.0s;
		}

		#waiting-effect span:nth-child(7) {
			background-color: #b5cbde;
			transform: scale(0.7);
		}

		#waiting-effect span:nth-child(7)::before {
			animation-delay: 1.2s;
		}

		#waiting-effect span:nth-child(8) {
			background-color: #cedce9;
			transform: scale(0.65);
		}

		#waiting-effect span:nth-child(8)::before {
			animation-delay: 1.4s;
		}

		#waiting-effect span:last-child {
			background-color: #e6edf4;
			transform: scale(0.6);
		}

		#waiting-effect span:last-child::before {
			animation-delay: 1.6s;
		}

		@keyframes ripples {
			from {
				opacity: 1;
				transform: scale(0);
			}
			to {
				opacity: 0;
				transform: scale(2);
			}
		}
	</style>
	<script>
		const updateStatus = (text) => {
			const s = document.getElementById('status');
			s.textContent = text;
		};

		let speed = 0;
		const bumpSpeed = () => {
			speed += 1;
			const s = document.getElementById('speed')
			if (speed > 2) {
				s.innerHTML = '&half;&times;';
				speed = 0;
			} else {
				s.innerHTML = `${speed}&times;`;
			}
		};

		const showStage = (s) => {
			for (let i = 1; i <= 3; i++) {
				const f = document.getElementById(`frame${i}`);
				if (f) {
					f.style.display = i === s ? 'block' : 'visible';
				}
			}
		};

		// config: { play: hide|disable|active, pause: ..., replay: ..., skip: ...}
		const buttonBar= (config) => {
			const defaults = {
				play: 'hide',
				pause: 'hide',
				replay: 'hide',
				skip: 'hide',
			};
			const control = { ...defaults, ...config };
			console.log(control);
			for (const c in defaults) {
				const b = document.getElementById(`${c}-button`);
				switch (control[c]) {
					case 'active':
						b.style.display = 'inline-block';
						b.disabled = false;
						break;
					case 'disable':
						b.style.display = 'inline-block';
						b.disabled = true;
						break;
					default:
						console.error(`Unknown control "${control[c]}" - treating as "hide"`);
						// fall-through
					case 'hide':
						b.style.display = 'none';
						b.disabled = true;
				}
			}
		};

		const stage12 = () => {
			showStage(1);
			const i = document.getElementById('image1');
			i.src = 'bags1-2.png';
			const m = document.getElementById('message1');
			m.classList.add('animate');
			m.addEventListener('animationend', () => {
				const w = document.getElementById('waiting');
				w.classList.add('show');
			}, { once : true, capture: true });
		}

		const jumpToStage = (s) => {
			const f = `stage${s}`;
			console.log(f);
			const fn = new Function(`return ${f}()`);
			fn();
		}

		let stage = 11;
		const nextStage = () => {
			switch (stage) {
				case 11:
					stage = 12;
					break;
				default:
					console.error(`Unknown stage: ${stage}`);
					stage = 11;
			}
			jumpToStage (stage);
		}

		const play = () => {
			updateStatus('Animation launching...');
			const b = document.getElementById('big-play')
			b.classList.remove('big-play-in');
			b.classList.add('big-play-out');
			b.addEventListener('animationend', () => {
				b.classList.add('big-play-hide');
				const f = document.getElementById('frame1');
				f.classList.remove('pointer');
				updateStatus('Animation playing...');
				nextStage();
			}, { once : true, capture: true });
		};

		const init = () => {
			updateStatus('Animation loading...');
			// start initial slide in
			const a = document.getElementById('animation');
			a.classList.add('animation-in');
			a.addEventListener('animationend', () => {
				// when fully visible, show the big play button in the middle
				const b = document.getElementById('big-play')
				b.classList.add('big-play-in');
				b.classList.remove('big-play-hide');
				const f = document.getElementById('frame1');
				f.classList.add('pointer');
				updateStatus('Animation ready');
			}, { once : true, capture: true });
			bumpSpeed();
			buttonBar({play: 'active', skip: 'active'});
		};
	</script>
</head>
<body onload="init();" id="body">
	<h1>
		Example animation.
	</h1>
	<div>
		<div class="outer">
			<div id="container" class="container">
				<div class="text">
					Two local businesses donated items for the party. They donated 18 glow sticks and 12 popular DVDs. Amir and Maria decide to assemble prize bags to give away to one or more lucky winners at the party. They want all of the prize bags to have the same number of DVDs and the same number of glow sticks, and they do not want to have any leftover items. What is the greatest number of prize bags they can make?
				</div>
				<div id="animation" class="animation">
					<button id="big-play" class="big-play big-play-hide" onclick="play();">
						<img src="play.png" \>
					</button>
					<div id="frame1" class=frame" onclick="play();">
						<div class="text">
							In your own words, restate the problem to a neighbor. Then discuss a few of your initial ideas and possible strategies for solving the problem. Remember that you do not want any prizes left over.
						</div>
						<div class="panel">
							<img id="image1" src="bags1-1.png" />
						</div>
						<div id="message1" class="message">
							Start by clicking the Add a bag button to add as many bags as you think you will need. Then enter the number of glow sticks and DVDs for each bag. To remove a bag, click on the bag and then click Delete. When you are finished, click Fill bags.
						</div>
					</div>
					<div id="waiting">
						<div id="waiting-message">
							Waiting
						</div>
						<div id="waiting-effect">
							<span></span>
							<span></span>
							<span></span>
							<span></span>
							<span></span>
							<span></span>
							<span></span>
							<span></span>
							<span></span>
						</div>
					</div>
					<div id="controlbar">
						<span id="buttons">
							<button id="play-button" onclick="play();">
								<span class="material-symbols-outlined">play_arrow</span>
							</button>
							<button id="pause-button" disabled>
								<span class="material-symbols-outlined">pause</span>
							</button>
							<button id="replay-button" disabled>
								<span class="material-symbols-outlined">reply</span>
							</button>
							<button id="skip-button">
								<span class="material-symbols-outlined">skip_next</span>
							</button>
						</span>
						<span id="frames">
							<button id="b_frame1" class="active-frame">
								<span class="material-symbols-outlined">counter_1</span>
							</button>
							<button id="b_frame2">
								<span class="material-symbols-outlined">counter_2</span>
							</button>
							<button id="b_frame3">
								<span class="material-symbols-outlined">counter_3</span>
							</button>
						</span>
						<span id="controls">
							<span id="speed" style="vertical-align: top"></span>
							<button onclick="bumpSpeed();">
								<span class="material-symbols-outlined">slow_motion_video</span>
							</button>
						</span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<p id="status">Page loading...</p>
</body>
</html>
